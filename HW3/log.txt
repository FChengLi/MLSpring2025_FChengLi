Using device: cuda
Epoch 1/30 [Train]: 100%|██████████| 313/313 [02:31<00:00,  2.07it/s]
[ Train | 001/030 ] loss = 0.88494, acc = 0.72694
Epoch 1/30 [Valid]: 100%|██████████| 114/114 [00:32<00:00,  3.55it/s]
[ Valid | 001/030 ] loss = 0.36771, acc = 0.87871
Best model found at epoch 1, saving model. Accuracy: 0.87871
Epoch 2/30 [Train]: 100%|██████████| 313/313 [02:22<00:00,  2.20it/s]
[ Train | 002/030 ] loss = 0.36235, acc = 0.88598
Epoch 2/30 [Valid]: 100%|██████████| 114/114 [00:22<00:00,  5.16it/s]
[ Valid | 002/030 ] loss = 0.26908, acc = 0.91818
Best model found at epoch 2, saving model. Accuracy: 0.91818
Epoch 3/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 003/030 ] loss = 0.25803, acc = 0.91554
Epoch 3/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.57it/s]
[ Valid | 003/030 ] loss = 0.28577, acc = 0.90490
Epoch 4/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 004/030 ] loss = 0.20489, acc = 0.93361
Epoch 4/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.63it/s]
[ Valid | 004/030 ] loss = 0.26800, acc = 0.91679
Epoch 5/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 005/030 ] loss = 0.15431, acc = 0.95108
Epoch 5/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.57it/s]
[ Valid | 005/030 ] loss = 0.25444, acc = 0.92424
Best model found at epoch 5, saving model. Accuracy: 0.92424
Epoch 6/30 [Train]: 100%|██████████| 313/313 [02:19<00:00,  2.24it/s]
[ Train | 006/030 ] loss = 0.12963, acc = 0.95827
Epoch 6/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.65it/s]
[ Valid | 006/030 ] loss = 0.25084, acc = 0.92830
Best model found at epoch 6, saving model. Accuracy: 0.92830
Epoch 7/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 007/030 ] loss = 0.10508, acc = 0.96745
Epoch 7/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.67it/s]
[ Valid | 007/030 ] loss = 0.24339, acc = 0.92990
Best model found at epoch 7, saving model. Accuracy: 0.92990
Epoch 8/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 008/030 ] loss = 0.09185, acc = 0.97075
Epoch 8/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.67it/s]
[ Valid | 008/030 ] loss = 0.23319, acc = 0.92775
Epoch 9/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 009/030 ] loss = 0.08290, acc = 0.97474
Epoch 9/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.45it/s]
[ Valid | 009/030 ] loss = 0.26437, acc = 0.93089
Best model found at epoch 9, saving model. Accuracy: 0.93089
Epoch 10/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.22it/s]
[ Train | 010/030 ] loss = 0.07783, acc = 0.97574
Epoch 10/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.67it/s]
[ Valid | 010/030 ] loss = 0.28611, acc = 0.91960
Epoch 11/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 011/030 ] loss = 0.07963, acc = 0.97414
Epoch 11/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.58it/s]
[ Valid | 011/030 ] loss = 0.27266, acc = 0.92459
Epoch 12/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 012/030 ] loss = 0.06948, acc = 0.97714
Epoch 12/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.62it/s]
[ Valid | 012/030 ] loss = 0.26919, acc = 0.92661
Epoch 00012: reducing learning rate of group 0 to 1.0000e-05.
Epoch 13/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 013/030 ] loss = 0.05039, acc = 0.98552
Epoch 13/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.49it/s]
[ Valid | 013/030 ] loss = 0.23118, acc = 0.93351
Best model found at epoch 13, saving model. Accuracy: 0.93351
Epoch 14/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 014/030 ] loss = 0.03385, acc = 0.99081
Epoch 14/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.64it/s]
[ Valid | 014/030 ] loss = 0.21974, acc = 0.93976
Best model found at epoch 14, saving model. Accuracy: 0.93976
Epoch 15/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 015/030 ] loss = 0.03412, acc = 0.98942
Epoch 15/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.62it/s]
[ Valid | 015/030 ] loss = 0.21627, acc = 0.93779
Epoch 16/30 [Train]: 100%|██████████| 313/313 [02:19<00:00,  2.24it/s]
[ Train | 016/030 ] loss = 0.02310, acc = 0.99401
Epoch 16/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.61it/s]
[ Valid | 016/030 ] loss = 0.21882, acc = 0.94278
Best model found at epoch 16, saving model. Accuracy: 0.94278
Epoch 17/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 017/030 ] loss = 0.02055, acc = 0.99411
Epoch 17/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.68it/s]
[ Valid | 017/030 ] loss = 0.21503, acc = 0.94223
Epoch 18/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 018/030 ] loss = 0.01948, acc = 0.99431
Epoch 18/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.62it/s]
[ Valid | 018/030 ] loss = 0.22137, acc = 0.94103
Epoch 19/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 019/030 ] loss = 0.01700, acc = 0.99551
Epoch 19/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.61it/s]
[ Valid | 019/030 ] loss = 0.21926, acc = 0.94310
Best model found at epoch 19, saving model. Accuracy: 0.94310
Epoch 20/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 020/030 ] loss = 0.01534, acc = 0.99621
Epoch 20/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.51it/s]
[ Valid | 020/030 ] loss = 0.22381, acc = 0.94064
Epoch 21/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 021/030 ] loss = 0.01421, acc = 0.99651
Epoch 21/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.58it/s]
[ Valid | 021/030 ] loss = 0.21937, acc = 0.94163
Epoch 00021: reducing learning rate of group 0 to 1.0000e-06.
Epoch 22/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 022/030 ] loss = 0.01199, acc = 0.99730
Epoch 22/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.57it/s]
[ Valid | 022/030 ] loss = 0.21631, acc = 0.94251
Epoch 23/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.22it/s]
[ Train | 023/030 ] loss = 0.01234, acc = 0.99770
Epoch 23/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.54it/s]
[ Valid | 023/030 ] loss = 0.21678, acc = 0.94031
Epoch 24/30 [Train]: 100%|██████████| 313/313 [02:20<00:00,  2.23it/s]
[ Train | 024/030 ] loss = 0.01274, acc = 0.99621
Epoch 24/30 [Valid]: 100%|██████████| 114/114 [00:20<00:00,  5.44it/s]
[ Valid | 024/030 ] loss = 0.21944, acc = 0.94141
No improvement for 5 consecutive epochs, early stopping.
Testing: 100%|██████████| 94/94 [00:26<00:00,  3.51it/s]
Submission file created!
Loading best model for visualization...
Extracting mid-level features: 100%|██████████| 114/114 [00:21<00:00,  5.31it/s]
/opt/conda/lib/python3.7/site-packages/sklearn/manifold/_t_sne.py:783: FutureWarning: The default initialization in TSNE will change from 'random' to 'pca' in 1.2.
  FutureWarning,
/opt/conda/lib/python3.7/site-packages/sklearn/manifold/_t_sne.py:793: FutureWarning: The default learning rate in TSNE will change from 200.0 to 'auto' in 1.2.
  FutureWarning,
Performing t-SNE for t-SNE of Mid-level Features (from layer3)...

t-SNE plot saved as tsne_mid.png
Extracting top-level features: 100%|██████████| 114/114 [00:21<00:00,  5.26it/s]
/opt/conda/lib/python3.7/site-packages/sklearn/manifold/_t_sne.py:783: FutureWarning: The default initialization in TSNE will change from 'random' to 'pca' in 1.2.
  FutureWarning,
/opt/conda/lib/python3.7/site-packages/sklearn/manifold/_t_sne.py:793: FutureWarning: The default learning rate in TSNE will change from 200.0 to 'auto' in 1.2.
  FutureWarning,
Performing t-SNE for t-SNE of Top-level Features (from avgpool)...

t-SNE plot saved as tsne_top.png
